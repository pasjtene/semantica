{% extends 'AdminBundle::layout.html.twig' %}
{% block meta %}
    <meta name = "{% trans from 'refer' %} home.title {% endtrans %}" >
    <meta name = "keywords" content = "{% trans from 'refer' %} home.description {% endtrans %}" >
{% endblock %}
{% block title %}
    Semantica Technologies Corporation - STC
{% endblock %}


{% block mycss %}
    <link rel="stylesheet" href="{{ asset('components/cssbase/datatablehelp.css') }}">
    <link rel="stylesheet" href="{{ asset('components/cssbase/datatablehelp2.css') }}">
    <style>

        strong{
            font-weight: bold;
        }
        footer{
            bottom: 0;
            width: 100% !important;
        }
        .mega-menu{
            z-index: 9999999999999999999999999999 !important;
        }
        #navadmin{
            padding-top: 1.5%;
        }
        #zone_table{
            height: 352px;
            overflow-y: auto;
        }
        .tabs{
           background-color: #0083c0;
        }
        .tabs a{
           color: white !important;
        }
        #close_commit{
            background-color: #f44336  !important;
            margin-top: 1%;
        }
        #commit_save{
            position: absolute;
            top: 10%;
            right: 0;
            height: 90%;
            width: 30%;
            z-index: 99999999999999999999;
            border-left: #E7E7E7 3px solid;
            border-top: #E7E7E7 3px solid;
            border-bottom: #E7E7E7 3px solid;
        }

        #commit_save .content
        {
            margin: 1%;
            margin-top: 20% !important ;
        }
        @media screen and (max-width:712px) {
            #commit_save{
                width: 50%;
            }

        }
        @media screen and (max-width:500px) {

            #commit_save{
                width: 80%;
            }
        }
    </style>
{% endblock %}

{% block main %}
    {{ parent() }}
    <div class="row" id="admin_detail">
        <div class="row">
            <div class="col s12">
                <br><br><br>
                <div class="row">
                    <div class="col s12">
                        <br>
                        <div class="col s12">
                            <a class="waves-effect waves-green btn-flat red white-text right-align right" href="{{ path('admin_homepage') }}">{% trans from 'private' %} project.back {% endtrans %}</a>
                        </div>
                    </div>

                    <div class="col s12">
                        <br>
                        <ul class="tabs">
                            <li class="tab col s3"><a href="#detail" class="active">{% trans from 'private' %} project.tab1 {% endtrans %}</a></li>
                            <li class="tab col s3"><a  href="#participator" class="">{% trans from 'private' %} project.tab2 {% endtrans %}</a></li>
                            <li class="tab col s3"><a href="#commit" class="">{% trans from 'private' %} project.tab3 {% endtrans %}</a></li>
                            <li class="tab col s3"><a href="#planning" class="">{% trans from 'private' %} project.tab4 {% endtrans %}</a></li>
                        </ul>
                    </div>
                    <div id="detail" class="col s12">
                        {{ render(controller('AdminBundle:Project:information',{'id':id})) }}
                    </div>
                    <div id="participator" class="col s12">
                        {{ render(controller('AdminBundle:Project:participator',{'id':id})) }}
                    </div>
                    <div id="commit" class="col s12">
                        {{ render(controller('AdminBundle:Project:commit',{'id':id})) }}
                    </div>
                    <div id="planning" class="col s12">
                        {{ render(controller('AdminBundle:Project:planning',{'id':id})) }}
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div class="row white" id="commit_save" style="display: none; height: 89.5% !important;">
        <div class="col s12">
            <span id="close_commit" class="btn-floating btn waves-effect waves-light red"><i class="material-icons">close</i></span>
        </div>
        <div class="col s12" >
            <div class="row content">
                <form class="col s12" method="post" action="{{ path('admin_commit_add',{projectid:id}) }}">
                    <div class="row">
                        <div class="input-field col s12">
                            <label for="description">{% trans from 'private' %} commit.choice {% endtrans %}</label>
                            <br><br>
                            <select name="task_id" id="task_id">
                                {% for task in tasks %}
                                    <option value="{{ task.id }}" >{{ task.libelle }}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                    <div class="row">
                        <input type="hidden" name="hidden" id="hidden" value="{{ id }}">
                        <div class="input-field col s12">
                            <i class="material-icons prefix">textsms</i>
                            <textarea id="description" name="description" class="materialize-textarea" data-length="300"></textarea>
                            <label for="description">{% trans from 'forms' %} form.base.description {% endtrans %}</label>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col s12">
                            <center>
                                <button class="waves-effect waves-green btn-flat btn  white-text center-align center" type="submit">{% trans from 'private' %} commit.add {% endtrans %}</button>
                            </center>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>

{% endblock %}

{% block myjs %}
    <script>
        var id = {{ id }};

        $(document).ready(function()
        {
            var hid = 0;

            var elt= {
                select: $('select'),
                modal: '.modal',
                closecommit:$('#close_commit'),
                opencommit:$('#new_commit'),
                body:$('#commit_save'),
                delete: $('.delete_projet'),
                btnNewTask : '.btn-new-task',
                planningId: $('#planning-id'),
                modalTask: $('#md-new-task'),
                editParticipator: '.edit-participator',
                btnNewParticipator: $("#btn-new-participator"),
                datepicker: '.datepicker'
            };


            elt.opencommit.click(function(e){
                elt.body.slideDown();
                e.preventDefault();
            });

            elt.closecommit.click(function(e){
                elt.body.slideUp();
                e.preventDefault();
            });

           elt.select.addClass('browser-default');

            $(elt.modal).modal();

            elt.delete.click(function(e)
            {
                if(!confirm($('#'+$(this).data('id')).text().trim()))
                {
                    e.preventDefault();
                }
            });

            $(elt.datepicker).pickadate();

            elt.btnNewParticipator.click(function(){
                $("#input-action").val("0");
            });

            $(elt.editParticipator).click(function(e)
            {
                var url = $(this).data('id');
                $('select[selected=selected]').removeAttr('selected');
                $.get(url, function(response){
                    console.log(response);
                });

                e.preventDefault();
            });

            $(elt.btnNewTask).click(function(e)
            {
                var pid = parseInt($(this).data('pid'));
                elt.planningId.val(pid);
                elt.modalTask.modal('open');
                e.preventDefault();
            })
        });
    </script>
{% endblock %}
